"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.inspect=exports.emitAsync=exports.emit=exports.once=exports.off=exports.on=void 0;var c=require("./utils");function d(c,d,e,f,g,h,i){try{var a=c[h](i),b=a.value}catch(j){e(j);return}a.done?d(b):Promise.resolve(b).then(f,g)}const a=(h,a,d,i={})=>{let b=c.splitEvents(d?a:h);if(d)for(let e=0;e<b.length;e++){let j=b[e];h.addEventListener(j,d,i)}else for(let f=0;f<b.length;f++){let g=b[f];if(c.listenerExists(g,a))return;c.createEvent(g),a&&c.eventsStack[g].push(a)}};exports.on=a;const b=(h,b,d)=>{let a=c.splitEvents(d?b:h);if(d)for(let e=0;e<a.length;e++){let i=a[e];h.removeEventListener(i,d)}else for(let f=0;f<a.length;f++){let g=a[f];if(!c.listenerExists(g,b))return;c.eventsStack[g].splice(c.eventsStack[g].indexOf(b),1)}};exports.off=b,exports.once=(c,e,f,g={})=>{if(f){let h=()=>{f(),b(c,e,h)};a(c,e,h,g)}else{let i=function(a){return function(){var b=this,c=arguments;return new Promise(function(f,g){var h=a.apply(b,c);function e(a){d(h,f,g,e,i,"next",a)}function i(a){d(h,f,g,e,i,"throw",a)}e(void 0)})}}(function*(){b(c,i),yield e()});a(c,i)}},exports.emit=(a,...d)=>{if(c.eventsStack[a])for(let b=0;b<c.eventsStack[a].length;b++)c.eventsStack[a][b](...d)},exports.emitAsync=(a,...b)=>{if(c.eventsStack[a])return Promise.all(c.eventsStack[a].map(a=>Promise.resolve(a(...b))))},exports.inspect=()=>c.clone()